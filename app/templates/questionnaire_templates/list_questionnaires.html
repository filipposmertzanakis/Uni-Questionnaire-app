{% extends 'base.html' %}

{% block title %}
Î›Î¯ÏƒÏ„Î± Î•ÏÏ‰Ï„Î·Î¼Î±Ï„Î¿Î»Î¿Î³Î¯Ï‰Î½
{% endblock %}

{% block content %}
<h1>Î›Î¯ÏƒÏ„Î± Î•ÏÏ‰Ï„Î·Î¼Î±Ï„Î¿Î»Î¿Î³Î¯Ï‰Î½</h1>

<!-- Î¦ÏŒÏÎ¼Î± Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ ÎºÎ±Î¹ Î¤Î±Î¾Î¹Î½ÏŒÎ¼Î·ÏƒÎ·Ï‚ -->
<form method="get" action="{{ url_for('user.search_questionnaires') }}">
    <input type="text" name="title" placeholder="Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î¼Îµ Ï„Î¯Ï„Î»Î¿" value="{{ title }}">
    <input type="text" name="student_name" placeholder="ÎŒÎ½Î¿Î¼Î± Î¦Î¿Î¹Ï„Î·Ï„Î®" value="{{ student_name }}">
    <input type="text" name="department" placeholder="Î¤Î¼Î®Î¼Î± Î¦Î¿Î¹Ï„Î·Ï„Î®" value="{{ department }}"><br><br>

    <label>Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î‘Ï€Î±Î½Ï„Î®ÏƒÎµÏ‰Î½ Î‘Ï€ÏŒ:</label>
    <input type="number" name="min_answers" min="0" value="{{ min_answers if min_answers is not none else '' }}">
    
    <label>ÎœÎ­Ï‡ÏÎ¹:</label>
    <input type="number" name="max_answers" min="0" value="{{ max_answers if max_answers is not none else '' }}"><br><br>

    <label>Î¤Î±Î¾Î¹Î½ÏŒÎ¼Î·ÏƒÎ· ÎºÎ±Ï„Î¬ Î±ÏÎ¹Î¸Î¼ÏŒ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÏ‰Î½:</label>
    <select name="sort_order">
        <option value="">ÎšÎ±Î¼Î¯Î± Î¤Î±Î¾Î¹Î½ÏŒÎ¼Î·ÏƒÎ·</option>
        <option value="asc" {% if sort_order == 'asc' %}selected{% endif %}>Î‘ÏÎ¾Î¿Ï…ÏƒÎ±</option>
        <option value="desc" {% if sort_order == 'desc' %}selected{% endif %}>Î¦Î¸Î¯Î½Î¿Ï…ÏƒÎ±</option>
    </select><br><br>

    <button type="submit">Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· / Î¤Î±Î¾Î¹Î½ÏŒÎ¼Î·ÏƒÎ·</button>
</form>

<hr>

<!-- Î›Î¯ÏƒÏ„Î± Î•ÏÏ‰Ï„Î·Î¼Î±Ï„Î¿Î»Î¿Î³Î¯Ï‰Î½ -->
{% if questionnaires %}
    <ul>
        {% for q in questionnaires %}
            <li>
                <a href="{{ url_for('user.view_questionnaire', questionnaire_id=q.questionnaire_id) }}">
                    {{ q.title }}
                </a>
                - Î‘Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚: {{ q.answer_count }}
                - Î”Î·Î¼Î¹Î¿Ï…ÏÎ³ÏŒÏ‚: {{ q.student_name }} ({{ q.department }})<br> 
                <!-- Î ÏÎ¿Î½ÏŒÎ¼Î¹Î± Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î® -->
                {% if session['admin_logged_in']  %}
                    <a href="{{ url_for('admin.edit_questionnaire', questionnaire_id=q.questionnaire_id) }}">âœï¸ Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î¤Î¹Ï„Î»Î¿Ï…	</a> |
                    <a href="{{ url_for('admin.view_answers', questionnaire_id=q.questionnaire_id) }}">ğŸ“Š Î£Ï„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬</a> |
                    <a href={{q.unique_url}}>{{q.unique_url}}</a> 
                    <form action="{{ url_for('admin.delete_questionnaire', questionnaire_id=q.questionnaire_id) }}" method="post"
                    class="no-style-form"
                    style="display:inline;">
                        <button class="delete-button" type="submit" onclick="return confirm('Î£Î¯Î³Î¿Ï…ÏÎ± Î¸ÎµÏ‚ Î½Î± Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÎ¹Ï‚;')">ğŸ—‘ï¸ Î”Î¹Î±Î³ÏÎ±Ï†Î®</button>
                    </form> 
                {% endif %}
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p>Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎµÏÏ‰Ï„Î·Î¼Î±Ï„Î¿Î»ÏŒÎ³Î¹Î±.</p>
{% endif %}

{% endblock %}
